{"cells":[{"cell_type":"markdown","metadata":{"id":"aaUh41dmifyz"},"source":["# Flask Webアプリで画像アップロード\n"]},{"cell_type":"markdown","metadata":{"id":"pflobZRUIdb6"},"source":["## proxy の設定\n","localhost のポート 5000 を外部に公開する proxy を求める。実行結果は localhost:5000 と表示されるが、実際の URL は異なっている点に注意。Flask の Web サーバを起動してから、ここで得られた URL の末尾にディレクトリ名やファイル名を追加してアクセスする。"]},{"cell_type":"code","execution_count":1,"metadata":{"id":"iTsx8FETBW5o","colab":{"base_uri":"https://localhost:8080/","height":34},"executionInfo":{"status":"ok","timestamp":1705537592318,"user_tz":-540,"elapsed":17,"user":{"displayName":"雅大宮崎","userId":"11037679152434260339"}},"outputId":"c2130192-18b1-4d30-a04f-28dd545b005f"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["(async (port, path, text, element) => {\n","    if (!google.colab.kernel.accessAllowed) {\n","      return;\n","    }\n","    element.appendChild(document.createTextNode(''));\n","    const url = await google.colab.kernel.proxyPort(port);\n","    const anchor = document.createElement('a');\n","    anchor.href = new URL(path, url).toString();\n","    anchor.target = '_blank';\n","    anchor.setAttribute('data-href', url + path);\n","    anchor.textContent = text;\n","    element.appendChild(anchor);\n","  })(5000, \"\", \"https://localhost:5000\", window.element)"]},"metadata":{}}],"source":["from google.colab import output\n","output.serve_kernel_port_as_window(5000, path='')"]},{"cell_type":"markdown","metadata":{"id":"5tLZ5rJNIl_K"},"source":["#Googleドライブのマウント\n","保存済みの重み付きモデルを取り出すため。"]},{"cell_type":"code","metadata":{"id":"FGf7Is0CY0eX","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1705537627961,"user_tz":-540,"elapsed":35653,"user":{"displayName":"雅大宮崎","userId":"11037679152434260339"}},"outputId":"406b9993-2f18-4ba4-d24b-753b7a28251d"},"source":["from google.colab import drive\n","drive.mount('/content/drive')"],"execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"markdown","metadata":{"id":"KIwtmn72FDSE"},"source":["#ファイルパスや分類クラスの設定"]},{"cell_type":"markdown","source":["##設定ファイルの中身を確認"],"metadata":{"id":"FXrAKlGHjZro"}},{"cell_type":"code","source":["##!cat \"/content/drive/MyDrive/Colab Notebooks/ImageClassification/ImageClassificationConfig.py\""],"metadata":{"id":"YTBQ0udFjZBi","executionInfo":{"status":"ok","timestamp":1705537627961,"user_tz":-540,"elapsed":19,"user":{"displayName":"雅大宮崎","userId":"11037679152434260339"}}},"execution_count":3,"outputs":[]},{"cell_type":"markdown","source":["##設定ファイルをimport"],"metadata":{"id":"dWGteNgVjmbV"}},{"cell_type":"code","source":["#import sys\n","#sys.path.append('/content/drive/MyDrive/MLData')\n","\n","#MLdeta内に保存した同ファイル「limao」を読み込ませている\n","#import ImageClassificationConfig as cfg\n","#import limao as cfg\n","\n","#import importlib\n","#importlib.reload(cfg)"],"metadata":{"id":"xjGpmAX9p2Uc","executionInfo":{"status":"ok","timestamp":1705537627962,"user_tz":-540,"elapsed":18,"user":{"displayName":"雅大宮崎","userId":"11037679152434260339"}}},"execution_count":4,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"GZ-22gF9mfDn"},"source":["1. cfg.PATH+'/'+cfg.DATA_NAME+'/test_data'フォルダを作る\n","(今回はGoogleドライブのマイドライブの下のMLDataの下のimages_dogcatの下にtest_dataというフォルダを作る）\n","2. 犬猫の画像をいくつか放り込んでおく"]},{"cell_type":"markdown","source":[],"metadata":{"id":"wwhwbR2_ibMM"}},{"cell_type":"code","source":["!mkdir -p /content/lwgan/resized_images\n","!mkdir -p /content/drive/MyDrive/lwgan\n","%cd /content/drive/MyDrive/lwgan\n","#PATH = '/content/drive/My Drive/MLData/'\n","#classes = ['icon_img']\n","#num_classes = len(classes)\n","#IMAGE_SIZE = 512\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"G_jfYqK2ib6N","executionInfo":{"status":"ok","timestamp":1705537627962,"user_tz":-540,"elapsed":17,"user":{"displayName":"雅大宮崎","userId":"11037679152434260339"}},"outputId":"0fb48698-742b-478d-8df0-99c9fe8e0c1f"},"execution_count":5,"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/lwgan\n"]}]},{"cell_type":"code","source":["predicts = {}"],"metadata":{"id":"ZUwn92QXaAEP","executionInfo":{"status":"ok","timestamp":1705537627962,"user_tz":-540,"elapsed":9,"user":{"displayName":"雅大宮崎","userId":"11037679152434260339"}}},"execution_count":6,"outputs":[]},{"cell_type":"markdown","source":["#インストール"],"metadata":{"id":"6WAK0J6-QD76"}},{"cell_type":"code","source":["pip install imgaug==0.2.5"],"metadata":{"id":"Bv6PPNJOQDiF","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1705537637443,"user_tz":-540,"elapsed":9490,"user":{"displayName":"雅大宮崎","userId":"11037679152434260339"}},"outputId":"3eed059f-286d-4780-c5b2-59817a28fd28"},"execution_count":7,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting imgaug==0.2.5\n","  Downloading imgaug-0.2.5.tar.gz (562 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m562.7/562.7 kB\u001b[0m \u001b[31m7.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from imgaug==0.2.5) (1.11.4)\n","Requirement already satisfied: scikit-image>=0.11.0 in /usr/local/lib/python3.10/dist-packages (from imgaug==0.2.5) (0.19.3)\n","Requirement already satisfied: numpy>=1.7.0 in /usr/local/lib/python3.10/dist-packages (from imgaug==0.2.5) (1.23.5)\n","Requirement already satisfied: six in /usr/local/lib/python3.10/dist-packages (from imgaug==0.2.5) (1.16.0)\n","Requirement already satisfied: networkx>=2.2 in /usr/local/lib/python3.10/dist-packages (from scikit-image>=0.11.0->imgaug==0.2.5) (3.2.1)\n","Requirement already satisfied: pillow!=7.1.0,!=7.1.1,!=8.3.0,>=6.1.0 in /usr/local/lib/python3.10/dist-packages (from scikit-image>=0.11.0->imgaug==0.2.5) (9.4.0)\n","Requirement already satisfied: imageio>=2.4.1 in /usr/local/lib/python3.10/dist-packages (from scikit-image>=0.11.0->imgaug==0.2.5) (2.31.6)\n","Requirement already satisfied: tifffile>=2019.7.26 in /usr/local/lib/python3.10/dist-packages (from scikit-image>=0.11.0->imgaug==0.2.5) (2023.12.9)\n","Requirement already satisfied: PyWavelets>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-image>=0.11.0->imgaug==0.2.5) (1.5.0)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from scikit-image>=0.11.0->imgaug==0.2.5) (23.2)\n","Building wheels for collected packages: imgaug\n","  Building wheel for imgaug (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for imgaug: filename=imgaug-0.2.5-py3-none-any.whl size=561418 sha256=27982c0df0e068f97859a9eeca3b86f90d6038963f7fb388d6ad32aa07aab1e8\n","  Stored in directory: /root/.cache/pip/wheels/0b/da/38/c07f5c84a267780ad9425f219f7f0a76a65bed6a75d0626c78\n","Successfully built imgaug\n","Installing collected packages: imgaug\n","  Attempting uninstall: imgaug\n","    Found existing installation: imgaug 0.4.0\n","    Uninstalling imgaug-0.4.0:\n","      Successfully uninstalled imgaug-0.4.0\n","Successfully installed imgaug-0.2.5\n"]}]},{"cell_type":"code","source":["!pip install aim lightweight-gan"],"metadata":{"id":"KNwog1UjQQKb","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1705537674192,"user_tz":-540,"elapsed":36763,"user":{"displayName":"雅大宮崎","userId":"11037679152434260339"}},"outputId":"6b6ba829-f038-47d6-b132-c0a205258190"},"execution_count":8,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting aim\n","  Downloading aim-3.17.5-cp310-cp310-manylinux_2_24_x86_64.whl (5.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m5.6/5.6 MB\u001b[0m \u001b[31m14.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting lightweight-gan\n","  Downloading lightweight_gan-1.1.1-py3-none-any.whl (20 kB)\n","Collecting aim-ui==3.17.5 (from aim)\n","  Downloading aim-ui-3.17.5.tar.gz (21.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m21.3/21.3 MB\u001b[0m \u001b[31m30.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting aimrecords==0.0.7 (from aim)\n","  Downloading aimrecords-0.0.7-py2.py3-none-any.whl (28 kB)\n","Collecting aimrocks==0.4.0 (from aim)\n","  Downloading aimrocks-0.4.0-cp310-cp310-manylinux_2_24_x86_64.whl (6.1 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m6.1/6.1 MB\u001b[0m \u001b[31m38.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: cachetools>=4.0.0 in /usr/local/lib/python3.10/dist-packages (from aim) (5.3.2)\n","Requirement already satisfied: click>=7.0 in /usr/local/lib/python3.10/dist-packages (from aim) (8.1.7)\n","Requirement already satisfied: cryptography>=3.0 in /usr/local/lib/python3.10/dist-packages (from aim) (41.0.7)\n","Requirement already satisfied: filelock<4,>=3.3.0 in /usr/local/lib/python3.10/dist-packages (from aim) (3.13.1)\n","Requirement already satisfied: numpy<2,>=1.12.0 in /usr/local/lib/python3.10/dist-packages (from aim) (1.23.5)\n","Requirement already satisfied: psutil>=5.6.7 in /usr/local/lib/python3.10/dist-packages (from aim) (5.9.5)\n","Collecting py3nvml>=0.2.5 (from aim)\n","  Downloading py3nvml-0.2.7-py3-none-any.whl (55 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m55.5/55.5 kB\u001b[0m \u001b[31m6.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting RestrictedPython>=5.1 (from aim)\n","  Downloading RestrictedPython-7.0-py3-none-any.whl (26 kB)\n","Requirement already satisfied: tqdm>=4.20.0 in /usr/local/lib/python3.10/dist-packages (from aim) (4.66.1)\n","Collecting aiofiles>=0.5.0 (from aim)\n","  Downloading aiofiles-23.2.1-py3-none-any.whl (15 kB)\n","Collecting alembic<2,>=1.5.0 (from aim)\n","  Downloading alembic-1.13.1-py3-none-any.whl (233 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m233.4/233.4 kB\u001b[0m \u001b[31m29.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting fastapi<1,>=0.69.0 (from aim)\n","  Downloading fastapi-0.109.0-py3-none-any.whl (92 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m92.0/92.0 kB\u001b[0m \u001b[31m12.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: jinja2<4,>=2.10.0 in /usr/local/lib/python3.10/dist-packages (from aim) (3.1.3)\n","Requirement already satisfied: pytz>=2019.1 in /usr/local/lib/python3.10/dist-packages (from aim) (2023.3.post1)\n","Collecting SQLAlchemy<2,>=1.4.1 (from aim)\n","  Downloading SQLAlchemy-1.4.51-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.6/1.6 MB\u001b[0m \u001b[31m8.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting uvicorn<1,>=0.12.0 (from aim)\n","  Downloading uvicorn-0.26.0-py3-none-any.whl (60 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m60.5/60.5 kB\u001b[0m \u001b[31m8.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: Pillow>=8.0.0 in /usr/local/lib/python3.10/dist-packages (from aim) (9.4.0)\n","Requirement already satisfied: protobuf<5,>=3.9.2 in /usr/local/lib/python3.10/dist-packages (from aim) (3.20.3)\n","Requirement already satisfied: packaging>=15.0 in /usr/local/lib/python3.10/dist-packages (from aim) (23.2)\n","Requirement already satisfied: python-dateutil in /usr/local/lib/python3.10/dist-packages (from aim) (2.8.2)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from aim) (2.31.0)\n","Collecting segment-analytics-python (from aim)\n","  Downloading segment_analytics_python-2.2.3-py2.py3-none-any.whl (24 kB)\n","Requirement already satisfied: grpcio>=1.42.0 in /usr/local/lib/python3.10/dist-packages (from aim) (1.60.0)\n","Collecting base58==2.0.1 (from aimrecords==0.0.7->aim)\n","  Downloading base58-2.0.1-py3-none-any.whl (4.3 kB)\n","Collecting adabelief-pytorch (from lightweight-gan)\n","  Downloading adabelief_pytorch-0.2.1-py3-none-any.whl (5.8 kB)\n","Collecting einops>=0.3 (from lightweight-gan)\n","  Downloading einops-0.7.0-py3-none-any.whl (44 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m44.6/44.6 kB\u001b[0m \u001b[31m6.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting fire (from lightweight-gan)\n","  Downloading fire-0.5.0.tar.gz (88 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m88.3/88.3 kB\u001b[0m \u001b[31m11.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting kornia>=0.5.4 (from lightweight-gan)\n","  Downloading kornia-0.7.1-py2.py3-none-any.whl (756 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m756.0/756.0 kB\u001b[0m \u001b[31m46.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting retry (from lightweight-gan)\n","  Downloading retry-0.9.2-py2.py3-none-any.whl (8.0 kB)\n","Requirement already satisfied: torch>=1.10 in /usr/local/lib/python3.10/dist-packages (from lightweight-gan) (2.1.0+cu121)\n","Requirement already satisfied: torchvision in /usr/local/lib/python3.10/dist-packages (from lightweight-gan) (0.16.0+cu121)\n","Collecting Mako (from alembic<2,>=1.5.0->aim)\n","  Downloading Mako-1.3.0-py3-none-any.whl (78 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m78.6/78.6 kB\u001b[0m \u001b[31m11.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: typing-extensions>=4 in /usr/local/lib/python3.10/dist-packages (from alembic<2,>=1.5.0->aim) (4.5.0)\n","Requirement already satisfied: cffi>=1.12 in /usr/local/lib/python3.10/dist-packages (from cryptography>=3.0->aim) (1.16.0)\n","Requirement already satisfied: pydantic!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0,>=1.7.4 in /usr/local/lib/python3.10/dist-packages (from fastapi<1,>=0.69.0->aim) (1.10.13)\n","Collecting starlette<0.36.0,>=0.35.0 (from fastapi<1,>=0.69.0->aim)\n","  Downloading starlette-0.35.1-py3-none-any.whl (71 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m71.1/71.1 kB\u001b[0m \u001b[31m8.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting typing-extensions>=4 (from alembic<2,>=1.5.0->aim)\n","  Downloading typing_extensions-4.9.0-py3-none-any.whl (32 kB)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2<4,>=2.10.0->aim) (2.1.3)\n","Collecting xmltodict (from py3nvml>=0.2.5->aim)\n","  Downloading xmltodict-0.13.0-py2.py3-none-any.whl (10.0 kB)\n","Requirement already satisfied: greenlet!=0.4.17 in /usr/local/lib/python3.10/dist-packages (from SQLAlchemy<2,>=1.4.1->aim) (3.0.3)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch>=1.10->lightweight-gan) (1.12)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.10->lightweight-gan) (3.2.1)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from torch>=1.10->lightweight-gan) (2023.6.0)\n","Requirement already satisfied: triton==2.1.0 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10->lightweight-gan) (2.1.0)\n","Collecting h11>=0.8 (from uvicorn<1,>=0.12.0->aim)\n","  Downloading h11-0.14.0-py3-none-any.whl (58 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m58.3/58.3 kB\u001b[0m \u001b[31m8.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting colorama>=0.4.0 (from adabelief-pytorch->lightweight-gan)\n","  Downloading colorama-0.4.6-py2.py3-none-any.whl (25 kB)\n","Requirement already satisfied: tabulate>=0.7 in /usr/local/lib/python3.10/dist-packages (from adabelief-pytorch->lightweight-gan) (0.9.0)\n","Requirement already satisfied: six in /usr/local/lib/python3.10/dist-packages (from fire->lightweight-gan) (1.16.0)\n","Requirement already satisfied: termcolor in /usr/local/lib/python3.10/dist-packages (from fire->lightweight-gan) (2.4.0)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->aim) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->aim) (3.6)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->aim) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->aim) (2023.11.17)\n","Requirement already satisfied: decorator>=3.4.2 in /usr/local/lib/python3.10/dist-packages (from retry->lightweight-gan) (4.4.2)\n","Collecting py<2.0.0,>=1.4.26 (from retry->lightweight-gan)\n","  Downloading py-1.11.0-py2.py3-none-any.whl (98 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m98.7/98.7 kB\u001b[0m \u001b[31m10.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting monotonic~=1.5 (from segment-analytics-python->aim)\n","  Downloading monotonic-1.6-py2.py3-none-any.whl (8.2 kB)\n","Collecting backoff~=2.1 (from segment-analytics-python->aim)\n","  Downloading backoff-2.2.1-py3-none-any.whl (15 kB)\n","Requirement already satisfied: pycparser in /usr/local/lib/python3.10/dist-packages (from cffi>=1.12->cryptography>=3.0->aim) (2.21)\n","Requirement already satisfied: anyio<5,>=3.4.0 in /usr/local/lib/python3.10/dist-packages (from starlette<0.36.0,>=0.35.0->fastapi<1,>=0.69.0->aim) (3.7.1)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->torch>=1.10->lightweight-gan) (1.3.0)\n","Requirement already satisfied: sniffio>=1.1 in /usr/local/lib/python3.10/dist-packages (from anyio<5,>=3.4.0->starlette<0.36.0,>=0.35.0->fastapi<1,>=0.69.0->aim) (1.3.0)\n","Requirement already satisfied: exceptiongroup in /usr/local/lib/python3.10/dist-packages (from anyio<5,>=3.4.0->starlette<0.36.0,>=0.35.0->fastapi<1,>=0.69.0->aim) (1.2.0)\n","Building wheels for collected packages: aim-ui, fire\n","  Building wheel for aim-ui (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for aim-ui: filename=aim_ui-3.17.5-py3-none-any.whl size=21435646 sha256=b3d61e25c22a2130905f9ca92a7f162257fab957320076b2e93e5d9d4aed9711\n","  Stored in directory: /root/.cache/pip/wheels/e6/2b/ec/d686b36856d96cb0cb97cb2f917a17cafb081207446d1b8446\n","  Building wheel for fire (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for fire: filename=fire-0.5.0-py2.py3-none-any.whl size=116934 sha256=e705a99e060168265e4156028577fc601b7bdfd96c92e60ac343267216b3dfea\n","  Stored in directory: /root/.cache/pip/wheels/90/d4/f7/9404e5db0116bd4d43e5666eaa3e70ab53723e1e3ea40c9a95\n","Successfully built aim-ui fire\n","Installing collected packages: monotonic, aimrocks, aim-ui, xmltodict, typing-extensions, SQLAlchemy, RestrictedPython, py, Mako, h11, fire, einops, colorama, base58, backoff, aiofiles, uvicorn, starlette, segment-analytics-python, retry, py3nvml, alembic, aimrecords, kornia, fastapi, adabelief-pytorch, lightweight-gan, aim\n","  Attempting uninstall: typing-extensions\n","    Found existing installation: typing_extensions 4.5.0\n","    Uninstalling typing_extensions-4.5.0:\n","      Successfully uninstalled typing_extensions-4.5.0\n","  Attempting uninstall: SQLAlchemy\n","    Found existing installation: SQLAlchemy 2.0.24\n","    Uninstalling SQLAlchemy-2.0.24:\n","      Successfully uninstalled SQLAlchemy-2.0.24\n","\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","lida 0.0.10 requires kaleido, which is not installed.\n","lida 0.0.10 requires python-multipart, which is not installed.\n","ipython-sql 0.5.0 requires sqlalchemy>=2.0, but you have sqlalchemy 1.4.51 which is incompatible.\n","tensorflow-probability 0.22.0 requires typing-extensions<4.6.0, but you have typing-extensions 4.9.0 which is incompatible.\u001b[0m\u001b[31m\n","\u001b[0mSuccessfully installed Mako-1.3.0 RestrictedPython-7.0 SQLAlchemy-1.4.51 adabelief-pytorch-0.2.1 aim-3.17.5 aim-ui-3.17.5 aimrecords-0.0.7 aimrocks-0.4.0 aiofiles-23.2.1 alembic-1.13.1 backoff-2.2.1 base58-2.0.1 colorama-0.4.6 einops-0.7.0 fastapi-0.109.0 fire-0.5.0 h11-0.14.0 kornia-0.7.1 lightweight-gan-1.1.1 monotonic-1.6 py-1.11.0 py3nvml-0.2.7 retry-0.9.2 segment-analytics-python-2.2.3 starlette-0.35.1 typing-extensions-4.9.0 uvicorn-0.26.0 xmltodict-0.13.0\n"]}]},{"cell_type":"markdown","metadata":{"id":"SKJ2z-7bJFBx"},"source":["#ライブラリの読み込み"]},{"cell_type":"code","metadata":{"id":"KekHmq9ZAfHB","executionInfo":{"status":"ok","timestamp":1705537687582,"user_tz":-540,"elapsed":13396,"user":{"displayName":"雅大宮崎","userId":"11037679152434260339"}}},"source":["import numpy as np\n","from tensorflow.keras.models import load_model\n","from PIL import Image\n","import matplotlib.pyplot as plt\n","\n","from lightweight_gan import Trainer"],"execution_count":9,"outputs":[]},{"cell_type":"code","source":["model_args = dict(\n","    name = 'default',\n","    results_dir = './static/results',\n","    models_dir = './models',\n","    batch_size = 10,\n","    gradient_accumulate_every = 4,\n","    attn_res_layers = [32],\n","    freq_chan_attn = False,\n","    disc_output_size = 1,\n","    dual_contrast_loss = False,\n","    antialias = False,\n","    image_size = 512,\n","    num_image_tiles = None,\n","    optimizer = 'adam',\n","    num_workers = None,\n","    fmap_max = 512,\n","    transparent = False,\n","    greyscale = False,\n","    lr = 2e-4,\n","    save_every = 1000,\n","    evaluate_every = 1000,\n","    aug_prob = None,\n","    aug_types = ['cutout', 'translation'],\n","    dataset_aug_prob = 0,\n","    calculate_fid_every = None,\n","    calculate_fid_num_images = 12800,\n","    clear_fid_cache = False,\n","    amp = False,\n","    load_strict = True\n",")\n","\n","model = Trainer(**model_args)\n","model.load(-1)#モデルロードは一度だけ\n","checkpoint = model.checkpoint_num\n","dir_result = model.generate('newimage', 3, checkpoint, 'default')\n","#miyamasaでもできます(ファイルは持ってくる必要あるけど)\n"],"metadata":{"id":"6gIKMCQckDAf","executionInfo":{"status":"ok","timestamp":1705537702304,"user_tz":-540,"elapsed":14734,"user":{"displayName":"雅大宮崎","userId":"11037679152434260339"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"50d785f2-29a3-4feb-d091-df9c2bae9bec"},"execution_count":10,"outputs":[{"output_type":"stream","name":"stderr","text":["WARNING:aim.utils.tracking:--------------------------------------------------------------------------\n","WARNING:aim.utils.tracking:                 Aim collects anonymous usage analytics.                 \n","WARNING:aim.utils.tracking:                        Read how to opt-out here:                         \n","WARNING:aim.utils.tracking:    https://aimstack.readthedocs.io/en/latest/community/telemetry.html    \n","WARNING:aim.utils.tracking:--------------------------------------------------------------------------\n"]},{"output_type":"stream","name":"stdout","text":["continuing from previous epoch - 125\n","loading from version 1.1.1\n"]},{"output_type":"stream","name":"stderr","text":["Saving generated default images: 100%|██████████| 3/3 [00:04<00:00,  1.40s/it]\n"]}]},{"cell_type":"markdown","metadata":{"id":"pec1k-VZthtM"},"source":["##重み付きモデルの読み込み\n","tensorflow.keras.models.load_model( ファイル名 ) を用いる"]},{"cell_type":"code","metadata":{"id":"bQYl4YfztoAe","executionInfo":{"status":"ok","timestamp":1705537702304,"user_tz":-540,"elapsed":8,"user":{"displayName":"雅大宮崎","userId":"11037679152434260339"}}},"source":["##model = load_model( cfg.PATH + '/treined_model-' + cfg.DATA_NAME + '-' + str(cfg.IMAGE_SIZE) + '.h5' )\n"],"execution_count":11,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"EoKXVbLManRZ"},"source":["## HTML template"]},{"cell_type":"markdown","metadata":{"id":"IsCuEIGzqQ5U"},"source":["### list.html"]},{"cell_type":"code","execution_count":12,"metadata":{"id":"M7-vK-3_ppbW","executionInfo":{"status":"ok","timestamp":1705537702802,"user_tz":-540,"elapsed":504,"user":{"displayName":"雅大宮崎","userId":"11037679152434260339"}}},"outputs":[],"source":["\"\"\"\n","アップロードした画像を一覧表示するための HTML\n","画像が無いときもこの HTML を表示\n","\n","\"\"\"\n","dirname = 'templates'\n","filename = 'list.html'\n","contents = \"\"\"\n","<!doctype html>\n","<html>\n","<head>\n","<meta charset=\"utf-8\">\n","<title>NEUCON</title>\n","<link rel=\"stylesheet\" href=\"/static/style.css\">\n","<link rel=\"icon\" href=\"../images/favicon.ico\" />\n","\n","\n","<link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n","<link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin>\n","<link href=\"https://fonts.googleapis.com/css2?family=Zen+Kaku+Gothic+New:wght@500&display=swap\" rel=\"stylesheet\">\n","\n","    <meta name=\"viewport\" content=\"width=device-width\" >\n","\n","</head>\n","\n","<body>\n","<div class=\"header\">\n","  <div class=\"head_r\"> <img src=\"/static/img/n.png\" alt=\"\" class=\"logo\">\n","    <h2>Neucon</h2>\n","  </div>\n","  <div class=\"head_l\">\n","    <p>&nbsp;</p>\n","  </div>\n","</div>\n","\t<p></p>\n","<div class=\"line\"> </div>\n","  <div class=\"home_body\">\n","\n","\n","\n","\n","\n","\n","\n","\n","\t  <div>\n","\t  <section class=\"hero\" id=\"hero\">\n","\t\t  <div class='hero_h'>\n","    <p class=\"hero_header\">ICON <span class=\"light\">GENERATE</span></p>\n","\t\t  </div>\n","\t\t  <div class='hero_p'>\n","    <p class=\"tagline\">AI makes me simple</p>\n","\t\t  </div>\n","\t\t  <img src=\"/static/img/bar.png\" alt=\"\" class=\"bar\">\n","\t\t  <p>&nbsp;</p>\n","  </section>\n","\t\t  <div class=\"body news flow_before\">\n","\t\t\t  <a href=\"/lgan.html\">Lganにとぶ<img src=\"/static/img/create.png\" alt=\"\" class=\"create\"></a>\n","\n","\t\t  </div>\n","\t  </div>\n","    <div class=\"body news flow_before\">\n","      <h1>news</h1>\n","      <ul>\n","        <a href=\"news/20220309_snewite.html\">\n","        <li>\n","            <div class=\"date\"><p>2023/01/13</p></div>\n","          <div class=\"info_type_notice\"><p>info</p></div>\n","          <div class=\"topic\"><p>サービスを開始しました。</p></div>\n","        </li>\n","        </a>\n","        <li>\n","          <div class=\"date\"><p>2023/xx/xx</p></div>\n","          <div class=\"info_type_notice\"><p>activity</p></div>\n","          <div class=\"topic\"><p>サービス終了のお知らせ</p></div>\n","        </li>\n","        <li>\n","          <div class=\"date\"><p>2023/xx/xx</p></div>\n","          <div class=\"info_type_notice\"><p>test</p></div>\n","          <div class=\"topic\"><p>サービス終了のお知らせ</p></div>\n","        </li>\n","        <li>\n","          <div class=\"date\"><p>2023/01/15</p></div>\n","          <div class=\"info_type_notice\"><p>event</p></div>\n","          <div class=\"topic\"><p>サービス終了のお知らせ</p></div>\n","        </li>\n","      </ul>\n","    </div>\n","\t      <div class=\"body about flow_before\">\n","\t  \t\t\t\t<img src=\"/static/img/bar.png\" alt=\"\" class=\"bar\">\n","\t  \t</div>\n","    <div class=\"body about flow_before\">\n","\n","      <h1>about</h1>\n","      <p>&nbsp;</p>\n","\n","      <p>neuconは、人工知能を用いたロゴ自動作成サービスです。<br>どんな人でも1クリックで誰でも簡単に画像を生成することができます&nbsp;</p>\n","\t\t<p>サーバー側で処理を行うため、PCのスペックに依存せずに利用できます&nbsp;</p>\n","    </div>\n","    <!--活動概要-->\n","    <div class=\"body Activity flow_before\">\n","      <div class=\"bgo\">\n","        <h1>&nbsp; </h1>\n","      </div>\n","\t\t<h1>いろんな使い方</h1>\n","      <div class=\"marea\">\n","        <div class=\"area bpic one flow_before\"> <img src=\"/static/img/o.png\" alt=\"\" class=\"area_icon\">\n","          <h2>アイデアに</h2>\n","          <p>作品の参考としてアイデアの引き出しに&nbsp;</p>\n","        </div>\n","\n","        <div class=\"area bpic three flow_before\"> <img src=\"/static/img/o.png\" alt=\"\" class=\"area_icon\">\n","          <h2>制作の下敷きに&nbsp;</h2>\n","          <p>生成画像を元に自分で好きにアレンジすることができます\n","            </p>\n","        </div>\n","\n","\n","\t\t  <div class=\"area bpic five flow_before\"> <img src=\"/static/img/o.png\" alt=\"\" class=\"area_icon\">\n","          <h2>自分のアイコンに&nbsp;</h2>\n","          <p>もちろんそのまま各種SNSアイコンにも使用できます&nbsp;</p>\n","        </div>\n","\n","      </div>\n","      <p class=\"flow_before\">これ以外にも使い方は様々あります。<br>\n","          ぜひ自分に合った使い方でお楽しみください。</p>\n","    </div>\n","    <div class=\" body suke flow_before\">\n","\n","      <p>やってみよう！</p>\n","    </div>\n","\n","    <div class=\"body games flow_before\">\n","\n","      <p>やってみよう</p>\n","\t\t<a href=\"/lgan.html\">Lganにとぶ<img src=\"/static/img/create.png\" alt=\"\" class=\"create\"></a>\n","    </div>\n","\n","      <!--\n","      <img src=\"/static/img/dotv_2.png\" class=\"v1 background\" alt=\"\">\n","-->\n","      <img src=\"/static/img/dotv.png\" class=\"v2 background\" alt=\"\">\n","      <img src=\"/static/img/sphrere_1_s.png\" class=\"s1 background\" alt=\"\">\n","      <img src=\"/static/img/sphrere_1_s.png\" class=\"s2 background\" alt=\"\">\n","      <img src=\"/static/img/sphrere_1_s.png\" class=\"s3 background\" alt=\"\">\n","      <img src=\"/static/img/sphrere_3_s.png\" class=\"s4 background\" alt=\"\">\n","      <img src=\"/static/img/sphrere_2_s.png\" class=\"s5 background\" alt=\"\">\n","      <img src=\"/static/img/dot_cube.png\" class=\"d1 background\" alt=\"\">\n","\n","\n","\n","</div>\n","\n","<script src=\"/static/move.js\"></script>\n","    <noscript>\n","  <style>\n","    .flow_before.flow_after {\n","      opacity: 1;\n","      visibility: visible;\n","      transform: translateY(0px);\n","    }\n","  </style>\n","</noscript>\n","</body>\n","    <footer>\n","  <p>@miyazaki_miyacat</p>\n","</footer>\n","</html>\n","\n","\"\"\"\n","\n","import  os\n","if not os.path.isdir(dirname):\n","    os.makedirs(dirname)\n","fp = open(dirname + '/' + filename, mode='w')\n","fp.write(contents)\n","fp.close()"]},{"cell_type":"markdown","metadata":{"id":"x-Ba5hbjv1j6"},"source":["### image.html"]},{"cell_type":"code","execution_count":13,"metadata":{"id":"1V5xbfkyvzcb","executionInfo":{"status":"ok","timestamp":1705537703151,"user_tz":-540,"elapsed":353,"user":{"displayName":"雅大宮崎","userId":"11037679152434260339"}}},"outputs":[],"source":["\"\"\"\n","アップロードした画像を一覧表示するための HTML\n","画像が無いときもこの HTML を表示\n","\"\"\"\n","dirname = 'templates'\n","filename = 'image.html'\n","contents = \"\"\"\n","<!DOCTYPE html>\n","<html>\n","  <head>\n","    <meta charset=\"utf-8\">\n","    <title>Image Collecter</title>\n","    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0,minimum-scale=1.0\">\n","    <link href=\"/templates/style.css\" rel=\"stylesheet\" type=\"text/css\">\n","  </head>\n","  <body>\n","    <h1>Image Collecter</h1>\n","    <p>{{ name }}</p>\n","    <p><a href=\"/\">戻る</a></p>\n","    <img src=\"/templates/{{ name }}\" width=\"100%\">\n","    <p><a href=\"/\">戻る</a></p>\n","  </body>\n","</html>\n","\"\"\"\n","\n","import  os\n","if not os.path.isdir(dirname):\n","    os.makedirs(dirname)\n","fp = open(dirname + '/' + filename, mode='w')\n","fp.write(contents)\n","fp.close()"]},{"cell_type":"markdown","metadata":{"id":"fnlxawYfwo8W"},"source":["### upload.html"]},{"cell_type":"code","execution_count":14,"metadata":{"id":"JU6s8jQHwmw4","executionInfo":{"status":"ok","timestamp":1705537704018,"user_tz":-540,"elapsed":871,"user":{"displayName":"雅大宮崎","userId":"11037679152434260339"}}},"outputs":[],"source":["\"\"\"\n","アップロードした画像を一覧表示するための HTML\n","画像が無いときもこの HTML を表示\n","\"\"\"\n","dirname = 'templates'\n","filename = 'upload.html'\n","contents = \"\"\"\n","<!DOCTYPE html>\n","<html>\n","  <head>\n","    <meta charset=\"utf-8\">\n","    <title>Image Collecter</title>\n","    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0,minimum-scale=1.0\">\n","    <link href=\"/templates/style.css\" rel=\"stylesheet\" type=\"text/css\">\n","  </head>\n","  <body>\n","    <h1>Image Collecter</h1>\n","    <p>アップロードする画像ファイルを選択してください。</p>\n","    <p><a href=\"/\">画像一覧</a></p>\n","    <form action=\"/upload\" method=\"post\" enctype=\"multipart/form-data\">\n","      <p><input type=\"file\" name=\"file_content\" accept=\"image/*\"></p>\n","      <p><input type=\"submit\" value=\"アップロード\"></p>\n","    </form>\n","  </body>\n","</html>\n","\"\"\"\n","\n","import  os\n","if not os.path.isdir(dirname):\n","    os.makedirs(dirname)\n","fp = open(dirname + '/' + filename, mode='w')\n","fp.write(contents)\n","fp.close()"]},{"cell_type":"markdown","source":["##Lgan.html"],"metadata":{"id":"jy2Ivj-KWNOq"}},{"cell_type":"code","source":["\"\"\"\n","ロードすると、画像が表示される\n","\"\"\"\n","dirname = 'templates'\n","filename = 'lgan.html'\n","contents = \"\"\"\n","\n","<!doctype html>\n","<html>\n","<head>\n","<meta charset=\"utf-8\">\n","<title>NEUCON</title>\n","<link rel=\"stylesheet\" href=\"/static/style.css\">\n","<link rel=\"icon\" href=\"../images/favicon.ico\" />\n","\n","\n","<link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n","<link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin>\n","<link href=\"https://fonts.googleapis.com/css2?family=Zen+Kaku+Gothic+New:wght@500&display=swap\" rel=\"stylesheet\">\n","\n","    <meta name=\"viewport\" content=\"width=device-width\" >\n","\n","</head>\n","\n","<body>\n","<div class=\"header\">\n","  <div class=\"head_r\"> <img src=\"/static/img/n.png\" alt=\"\" class=\"logo\">\n","    <h2>Neucon</h2>\n","  </div>\n","  <div class=\"head_l\">\n","    <p>&nbsp;</p>\n","  </div>\n","</div>\n","\t<p></p>\n","<div class=\"line\"> </div>\n","  <div class=\"home_body\">\n","\n","\n","\n","\n","\n","\n","\n","\n","\t <p>渾身の一作！</p>\n","\n","\n","\n","      <div class=\"marea\">\n","        <div class=\"area bpic one flow_before\"> <img src=\"{{image_path}}\" alt=\"\" class=\"area_icon\">\n","\n","        </div>\n","\n","        <div class=\"area bpic three flow_before\"> <img src=\"{{image_path2}}\" alt=\"\" class=\"area_icon\">\n","\n","        </div>\n","\n","\n","\t\t  <div class=\"area bpic five flow_before\"> <img src=\"{{image_path3}}\" alt=\"\" class=\"area_icon\">\n","\n","        </div>\n","\t\t  <div class=\"area bpic five flow_before\"> <img src=\"{{image_path4}}\" alt=\"\" class=\"area_icon\">\n","\n","        </div>\n","        \t\t  <div class=\"area bpic five flow_before\"> <img src=\"{{image_path5}}\" alt=\"\" class=\"area_icon\">\n","\n","        </div>\n","        \t\t  <div class=\"area bpic five flow_before\"> <img src=\"{{image_path1}}\" alt=\"\" class=\"area_icon\">\n","\n","        </div>\n","                \t\t  <div class=\"area bpic five flow_before\"> <img src=\"{{image_path6}}\" alt=\"\" class=\"area_icon\">\n","\n","        </div>\n","                \t\t  <div class=\"area bpic five flow_before\"> <img src=\"{{image_path7}}\" alt=\"\" class=\"area_icon\">\n","\n","        </div>\n","      <!--\n","      <img src=\"/static/img/dotv_2.png\" class=\"v1 background\" alt=\"\">\n","-->\n","      <img src=\"/static/img/dotv.png\" class=\"v2 background\" alt=\"\">\n","      <img src=\"/static/img/sphrere_1_s.png\" class=\"s1 background\" alt=\"\">\n","      <img src=\"/static/img/sphrere_1_s.png\" class=\"s2 background\" alt=\"\">\n","      <img src=\"/static/img/sphrere_1_s.png\" class=\"s3 background\" alt=\"\">\n","      <img src=\"/static/img/sphrere_3_s.png\" class=\"s4 background\" alt=\"\">\n","      <img src=\"/static/img/sphrere_2_s.png\" class=\"s5 background\" alt=\"\">\n","      <img src=\"/static/img/dot_cube.png\" class=\"d1 background\" alt=\"\">\n","\n","\n","\n","</div>\n","\n","\n","\n","\n","   <div class='tool_pare'>\n","   <div class='tool_item'>\n","\n","   <form action=\"{{ url_for('lganPage') }}\" method=\"POST\">\n","      <input type='image'name=\"img\"  class=\"create\" src=\"/static/img/download.png\">\n","   </form>\n","\n","      <a href=\"lgan.html\"><img  class=\"create\" src=\"/static/img/recreate.png\"></a>\n","\n","    </div>\n","    </div>\n","\n","{% for img in imglst %}\n","    <div class=\"imageBox\">\n","      <p>\n","        <a href=\"image/{{ name }}\">\n","          <div class=\"imageTitle\">{{ img.classname }} ({{ img.score }}) {{ img.filename }} </div>\n","          <img src=\"/templates/{{ img.filename }}\" width=\"100%\">\n","        </a>\n","      </p>\n","    </div>\n","    {% endfor %}\n","\n","<form action=\"{{ url_for('lganPage') }}\" method=\"POST\">\n","    <label for=\"last_name\">名字: </label><input type=\"number\" name=\"last_name\">\n","\n","\n","    <input type=\"submit\" value=\"数\">\n","</form>\n","<a href=\"{{image_path}}\" download>任意のテキスト</a>\n","\n","{% if last_name %}\n","<p>{{last_name}}</p>\n","{% endif %}\n","\n","{% if pre %}\n","<p>{{pre}}</p>\n","{% endif %}\n","\n","{% if err %}\n","<p>{{err}}</p>\n","{% endif %}\n","<script src=\"/static/move.js\"></script>\n","    <noscript>\n","  <style>\n","    .flow_before.flow_after {\n","      opacity: 1;\n","      visibility: visible;\n","      transform: translateY(0px);\n","    }\n","  </style>\n","</noscript>\n","</body>\n","    <footer>\n","  <p>@miyazaki_miyacat</p>\n","</footer>\n","</html>\n","\n","\"\"\"\n","\n","import  os\n","if not os.path.isdir(dirname):\n","    os.makedirs(dirname)\n","fp = open(dirname + '/' + filename, mode='w')\n","fp.write(contents)\n","fp.close()"],"metadata":{"id":"-p18Lp8sWMbY","executionInfo":{"status":"ok","timestamp":1705537704492,"user_tz":-540,"elapsed":479,"user":{"displayName":"雅大宮崎","userId":"11037679152434260339"}}},"execution_count":15,"outputs":[]},{"cell_type":"markdown","source":["じゃヴぁｓｃりｐｔ"],"metadata":{"id":"MhWt1XJa7Kt4"}},{"cell_type":"code","source":["dirname = 'static'\n","filename = 'move.js'\n","contents = \"\"\"\n","// JavaScript Document\n","function scroll_effect(){\n","    var material = document.getElementsByClassName(\"flow_before\");\n","    if(!material) return;\n","\n","    var scroll = window.pageYOffset;\n","    var window_height = window.innerHeight;\n","    var time = 200;\n","\n","    for(var x =0; x < material.length; x++){\n","        var mate_rect = material[x].getBoundingClientRect();\n","        var mateY = scroll + mate_rect.top;\n","        if(scroll > mateY - window_height + time){\n","            material[x].classList.add(\"flow_after\");\n","\n","           }\n","    }\n","}\n","window.addEventListener('scroll',scroll_effect);\"\"\"\n","import  os\n","if not os.path.isdir(dirname):\n","    os.makedirs(dirname)\n","fp = open(dirname + '/' + filename, mode='w')\n","fp.write(contents)\n","fp.close()"],"metadata":{"id":"D9zzX-eZ7PUD","executionInfo":{"status":"ok","timestamp":1705537704931,"user_tz":-540,"elapsed":441,"user":{"displayName":"雅大宮崎","userId":"11037679152434260339"}}},"execution_count":16,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"yayF5oN2iQ5x"},"source":["## CSS"]},{"cell_type":"markdown","metadata":{"id":"802XXk5YzDmf"},"source":["### style.css"]},{"cell_type":"code","execution_count":17,"metadata":{"id":"Op0ZccGpjS7T","executionInfo":{"status":"ok","timestamp":1705537705432,"user_tz":-540,"elapsed":506,"user":{"displayName":"雅大宮崎","userId":"11037679152434260339"}}},"outputs":[],"source":["\"\"\"\n","HTML を表示するときのレイアウトやデザインを指定する\n","\"\"\"\n","dirname = 'static'\n","filename = 'style.css'\n","contents = \"\"\"@charset \"utf-8\";\n","/* CSS Document */\n","*{\n","\n","}\n","@media screen and (min-width:700px){\n","    *{\n","    font-weight: 900;\n","    margin: 0;\n","    padding: 0;\n","    box-sizing: border-box;\n","    font-family: 'Zen Kaku Gothic New', sans-serif;\n","\n","    }\n","}\n","@media screen and (max-width:699px){\n","    *{font-weight: 400;\n","    margin: 0;\n","    padding: 0;\n","    box-sizing: border-box;\n","    font-family: 'Zen Kaku Gothic New', sans-serif;\n","\n","    }\n","}\n",".hero{\n","\theight: 360px;\n","\t//background-color: #A26D6E;\n","}\n","\n","header.h2{\n","    font-weight: 900;\n","}\n","\n","_::-webkit-full-page-media,_:future,:root .CSS{\n","\n","}\n","body{\n","    width: 100vw;\n","    min-height: 100vh;\n","    height: 100%;\n","    color: #434554;\n","    position: relative;\n","    background-color: #E0DFD9\n","    overflow-x: hidden;\n","\n","\n","}\n","\n",".hero_h{\n","\tfont-size: 50px;\n","\t\ttransition:  0.3s;\n","\n","}\n",".hero_h:hover {\n","\tfont-size: 60px;\n","\ttransition:  0.3s;\n","}\n",".hero_p{\n","\tfont-size: 20px;\n","\t\ttransition:  0.3s;\n","\n","}\n",".hero_p:hover{\n","\tfont-size: 25px;\n","\ttransition:  0.3s;\n","}\n",".bar{\n","\tmax-width: 500px;\n","\n","}\n","\n",".create{\n","\tmax-width: 390px;\n","}\n","\n",".create{\n","\n","    height:90%;\n","    display: flex;\n","    margin: 0.5% auto;\n","    padding: 1vw ;\n","\n","    top: 50%;\n","    transform: translateY(-50%);\n","    transition:  0.2s;\n","    font-size:min(105%,3.2vw);\n","    min-height: 25px;\n","    white-space: nowrap;\n","    overflow: hidden;\n","    text-overflow: ellipsis;\n","\tmax-width: 390px;\n","\n","}\n",".create:hover{\n","\n","    transition:  0.3s;\n","    max-width: 410px;\n","    cursor: pointer;\n","\n","}\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","a{\n","    color:#4B4C54;\n","    text-decoration: none;\n","}\n","h2{\n","    font-size: 1.5rem;\n","}\n","\n","/*(^^)*/\n",".main{\n","}\n",".header{\n","    width: 100%;\n","    height: 70px;\n","    display: flex;\n","\n","    color: #18191B;\n","}\n",".logo{\n","    width: 50px;\n","\n","}\n",".head_r{\n","    margin-left: 3%;\n","    display: flex;\n","    align-items: center;\n","}\n",".head_r h2{\n","    margin-left: 7%;\n","}\n",".head_l{\n","    position: relative;\n","    width: 70%;\n","    text-align: right;\n","\n","}\n",".line{\n","    width: 100%;\n","    height: 3px;\n","    background:linear-gradient(90deg, #8E2D8B,6%,#EA7153,#E22B6C,90%,#8E2D8B);\n","}\n",".home_body{\n","    width: 80%;\n","    text-align: center;\n","    margin: 10% auto;\n","\n","}\n",".body{\n","    margin: 16% 0px;\n","}\n",".news{\n","\n","    margin: 6% auto;\n","    min-height: 300px;\n","    /*background-color: #888888;*/\n","}\n",".info_type_notice{\n","    font-size: min(100%,3.2vw);\n","}\n","ul{\n","\n","    margin: 5% auto;\n","    font-size: 100%;\n","\n","}\n","li{\n","\n","    height:90%;\n","    display: flex;\n","    margin: 0.5% auto;\n","    padding: 1vw ;\n","    background-color: #DEE6ED;\n","    top: 50%;\n","    transform: translateY(-50%);\n","    transition:  0.2s;\n","    font-size:min(105%,3.2vw);\n","    min-height: 25px;\n","    white-space: nowrap;\n","    overflow: hidden;\n","    text-overflow: ellipsis;\n","\n","\n","}\n","li:hover{\n","    background-color: aliceblue;\n","    transition:  0.3s;\n","    font-size: min(115%,3.6vw);\n","    color:#D75590;\n","    cursor: pointer;\n","\n","}\n",".info_type_notice{\n","    width: 5%;\n","    margin: 0% 8%;\n","    display: inline-block;\n","}\n",".bego{\n","\n","}\n",".bpic{\n","\n","    max-width: 210px;\n","    height: 40%;\n","    margin: 5% 1% 7% 1%;\n","    /*background-color: aqua;*/\n","\n","}\n",".marea{\n","    display: flex;\n","    justify-content: center;\n","    flex-wrap: wrap;\n","}\n",".area_icon{\n","\n","\n","    max-height: 230px;\n","    max-width: 230px;\n","    padding: 4% 0;\n","    min-width: 1%;\n","\n","}\n","footer{\n","\n","    height: 100px;\n","    padding: 0% 0% 0% 0%;\n","    background-color: #2C2C34;\n","    text-align: center;\n","\n","    color: aliceblue;\n","\n","\n","    bottom: 0;\n","}\n",".background{\n","    opacity: 0.3;\n","    position:absolute;\n","    z-index: -1;\n","    max-width: 100%;\n","\n","}\n",".v1{\n","    top: 5%;\n","    left: 85%;\n","}\n",".v2{\n","    opacity: 0.2;\n","    width: 25%;\n","    top: 85%;\n","    left: 80%;\n","}\n",".s1{\n","    opacity: 0.2;\n","    width: 25%;\n","    top: 14%;\n","    left: 3%;\n","}\n",".s2{\n","    opacity: 0.2;\n","    width: 20%;\n","    top: 54%;\n","    left: 80%;\n","}\n",".s3{\n","    opacity: 0.2;\n","    width: 10%;\n","    top: 77%;\n","    left: 5%;\n","}\n",".s4{\n","    opacity: 0.08;\n","    width: 40%;\n","    top: 67%;\n","    left: 50%;\n","\n","\n","}\n",".s5{\n","    opacity: 0.08;\n","    width: 70%;\n","    top: 39%;\n","    left: 1%;\n","    transform: rotate(225deg);\n","    overflow-y: hidden;\n","}\n",".d1{\n","    opacity: 0.25;\n","    width: 40%;\n","    top: 21%;\n","    left: 50%;\n","\n","}\n","\n",".flow_before{\n","    opacity: 0;\n","    visibility: hidden;\n","    transform: translateY(50px);\n","    transition:  1s;\n","\n","}\n",".flow_before.flow_after{\n","    opacity: 1;\n","    visibility:visible;\n","    transform: translateY(0px);\n","\n","\n","}\n","_::-webkit-full-page-media, _:future, :root .flow_before{\n","    opacity: 1;\n","    visibility: visible;\n","    transform: translateY(-50px);\n","}\n","\n","\"\"\"\n","\n","import  os\n","if not os.path.isdir(dirname):\n","    os.makedirs(dirname)\n","fp = open(dirname + '/' + filename, mode='w')\n","fp.write(contents)\n","fp.close()"]},{"cell_type":"markdown","metadata":{"id":"Qbgg73fqbQkJ"},"source":["## アプリケーションサーバ\n","Python と Flask で作成したプログラムコード"]},{"cell_type":"markdown","source":[],"metadata":{"id":"TpWugzYl9p3w"}},{"cell_type":"markdown","metadata":{"id":"AHUfTOPMoO6O"},"source":["### プログラムメイン部分\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Gk-wSe4JnUFU","colab":{"base_uri":"https://localhost:8080/"},"outputId":"4182d4f9-40ac-4cf5-9ac1-5f5ced6ffb07"},"outputs":[{"output_type":"stream","name":"stdout","text":[" * Serving Flask app '__main__'\n"," * Debug mode: off\n"]},{"output_type":"stream","name":"stderr","text":["INFO:werkzeug:\u001b[31m\u001b[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.\u001b[0m\n"," * Running on http://127.0.0.1:5000\n","INFO:werkzeug:\u001b[33mPress CTRL+C to quit\u001b[0m\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:28:32] \"GET / HTTP/1.1\" 200 -\n"]},{"output_type":"stream","name":"stdout","text":[">>> list() called:\n",">>> get_list() called:\n","imglst:  []\n"]},{"output_type":"stream","name":"stderr","text":["INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:28:33] \"GET /static/style.css HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:28:33] \"GET /static/move.js HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:28:33] \"GET /static/img/dot_cube.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:28:34] \"GET /static/img/create.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:28:34] \"GET /static/img/n.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:28:34] \"GET /static/img/bar.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:28:34] \"GET /static/img/dotv.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:28:34] \"GET /static/img/sphrere_3_s.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:28:34] \"GET /static/img/sphrere_2_s.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:28:34] \"GET /static/img/sphrere_1_s.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:28:34] \"GET /static/img/o.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:28:35] \"\u001b[33mGET /images/favicon.ico HTTP/1.1\u001b[0m\" 404 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:09] \"GET / HTTP/1.1\" 200 -\n"]},{"output_type":"stream","name":"stdout","text":[">>> list() called:\n",">>> get_list() called:\n","imglst:  []\n"]},{"output_type":"stream","name":"stderr","text":["INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:09] \"GET /static/style.css HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:10] \"GET /static/img/bar.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:10] \"GET /static/img/n.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:10] \"GET /static/img/create.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:10] \"GET /static/img/sphrere_2_s.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:10] \"GET /static/img/sphrere_3_s.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:10] \"GET /static/img/dot_cube.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:10] \"GET /static/img/o.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:10] \"GET /static/img/sphrere_1_s.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:10] \"GET /static/move.js HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:10] \"GET /static/img/dotv.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:11] \"\u001b[33mGET /images/favicon.ico HTTP/1.1\u001b[0m\" 404 -\n"]},{"output_type":"stream","name":"stdout","text":[">>> lgan called\n"]},{"output_type":"stream","name":"stderr","text":["Saving generated default images: 100%|██████████| 8/8 [00:02<00:00,  2.82it/s]\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:32] \"GET /lgan.html HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:32] \"GET /static/style.css HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:32] \"GET /static/results/default-generated-125/newimage-1.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:33] \"GET /static/img/n.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:33] \"GET /static/results/default-generated-125/newimage-3.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:33] \"GET /static/results/default-generated-125/newimage-5.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:33] \"GET /static/results/default-generated-125/newimage-4.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:33] \"GET /static/img/dotv.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:34] \"GET /static/move.js HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:34] \"GET /static/results/default-generated-125/newimage-7.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:34] \"GET /static/img/sphrere_2_s.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:34] \"GET /static/img/dot_cube.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:34] \"GET /static/img/recreate.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:34] \"GET /static/results/default-generated-125/newimage-2.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:34] \"GET /static/results/default-generated-125/newimage-6.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:34] \"GET /static/img/sphrere_3_s.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:35] \"\u001b[33mGET /static/results/default-generated-125/newimage-8.jpg HTTP/1.1\u001b[0m\" 404 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:35] \"GET /static/img/sphrere_1_s.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:35] \"GET /static/img/download.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:36] \"\u001b[33mGET /images/favicon.ico HTTP/1.1\u001b[0m\" 404 -\n"]},{"output_type":"stream","name":"stdout","text":[">>> lgan called\n"]},{"output_type":"stream","name":"stderr","text":["Saving generated default images: 100%|██████████| 8/8 [00:00<00:00, 16.10it/s]\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:43] \"GET /lgan.html HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:43] \"GET /static/style.css HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:43] \"GET /static/img/n.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:43] \"GET /static/results/default-generated-125/newimage-3.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:43] \"GET /static/results/default-generated-125/newimage-4.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:44] \"GET /static/results/default-generated-125/newimage-5.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:44] \"GET /static/move.js HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:44] \"GET /static/results/default-generated-125/newimage-1.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:44] \"GET /static/results/default-generated-125/newimage-6.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:44] \"\u001b[33mGET /static/results/default-generated-125/newimage-8.jpg HTTP/1.1\u001b[0m\" 404 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:44] \"GET /static/img/sphrere_2_s.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:44] \"GET /static/img/recreate.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:45] \"GET /static/img/sphrere_3_s.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:45] \"GET /static/results/default-generated-125/newimage-7.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:45] \"GET /static/img/sphrere_1_s.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:45] \"GET /static/img/dot_cube.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:45] \"GET /static/img/dotv.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:45] \"GET /static/results/default-generated-125/newimage-2.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:45] \"GET /static/img/download.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:46] \"\u001b[33mGET /images/favicon.ico HTTP/1.1\u001b[0m\" 404 -\n"]},{"output_type":"stream","name":"stdout","text":[">>> lgan called\n"]},{"output_type":"stream","name":"stderr","text":["Saving generated default images: 100%|██████████| 8/8 [00:00<00:00, 16.90it/s]\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:53] \"GET /lgan.html HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:53] \"GET /static/style.css HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:53] \"GET /static/results/default-generated-125/newimage-3.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:53] \"GET /static/img/n.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:53] \"GET /static/results/default-generated-125/newimage-1.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:53] \"GET /static/results/default-generated-125/newimage-4.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:54] \"GET /static/results/default-generated-125/newimage-5.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:54] \"GET /static/results/default-generated-125/newimage-6.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:54] \"\u001b[33mGET /static/results/default-generated-125/newimage-8.jpg HTTP/1.1\u001b[0m\" 404 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:54] \"GET /static/results/default-generated-125/newimage-7.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:54] \"GET /static/img/download.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:54] \"GET /static/img/dotv.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:55] \"GET /static/img/sphrere_1_s.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:55] \"GET /static/img/sphrere_2_s.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:55] \"GET /static/move.js HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:55] \"GET /static/img/dot_cube.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:55] \"GET /static/img/recreate.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:55] \"GET /static/img/sphrere_3_s.png HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:55] \"GET /static/results/default-generated-125/newimage-2.jpg HTTP/1.1\" 200 -\n","INFO:werkzeug:127.0.0.1 - - [18/Jan/2024 00:29:56] \"\u001b[33mGET /images/favicon.ico HTTP/1.1\u001b[0m\" 404 -\n"]}],"source":["import os\n","import glob\n","import re\n","import base64\n","import datetime\n","import random\n","\n","from flask import Flask, render_template, request, redirect, url_for, jsonify,send_file\n","\n","#app = Flask(__name__,static_folder=\"./templates\")\n","app = Flask(__name__)\n","#画像はststicfileじゃないと読み込まないみたい・・・\n","#このせいでcssが読み込まれていないので、変えておこう\n","#プロジェクト自体はバックアップを取っておこう\n","#13日に発表\n","\n","\n","\n","\n","# 画像保存フォルダ（static）から画像の一覧を作る関数\n","# 対象となる画像ファイル（拡張子：jpg,jpeg,png）のリストを作成\n","def get_list():\n","    print('>>> get_list() called:')\n","    imglst = [os.path.basename(fn) for fn in glob.glob('static/default-generated-125/*')###\n","              if re.search('\\.(jpg|jpeg|png|JPG|JPEG|PNG)$', fn)]\n","\n","    print('imglst: ', imglst)\n","    return imglst\n","\n","\n","\n","# サーバのトップURLに対して返すページの生成\n","# 関数index()が呼ばれる\n","# アップロード済みの画像一覧が表示されるようにしたい\n","@app.route('/')\n","def list():\n","    print('>>> list() called:')\n","    # アップロード済みの画像を一覧表示する。\n","    # 画像一覧のリストを得るために、別の関数 get_list() を呼び出している。\n","    # その後、テンプレート list.html を使って、画像の一覧をブラウザに表示。\n","    return render_template('list.html', imglst=get_list())\n","\n","# 指定した画像をひとつだけ表示する\n","@app.route('/image/<filename>')\n","def image(filename):\n","    # 選択した画像だけ表示する\n","    # 単独の画像表示用テンプレートHTMLファイルと、表示したい画像ファイル名を\n","    # 引数として、render_template() を呼び出す\n","    # render_template(＜テンプレートファイル＞, ＜テンプレートに渡す画像ファイル名＞)\n","    print('>>> image('+filename+') called:')\n","    return render_template('image.html', name=filename)\n","\n","\n","# アップロードページを表示\n","@app.route('/upload.html')\n","def uploadPage():\n","    print('>>> uploadPage() called:')\n","    return render_template('upload.html')\n","\n","@app.route(\"/lgan.html\", methods=[\"GET\",\"POST\"])\n","def lganPage():\n","  print('>>> lgan called')\n","  err =  None\n","  if(request.method == 'POST'):# リクエストがPOSTの場合\n","\n","    last_name = request.form.get('last_name')# last_nameを取得\n","    #pre = request.form.get('pre')# last_nameを取得\n","    if(str.isdigit(last_name) == False):\n","      last_name = 8\n","      err = '数字入れてね'\n","   # else:\n","     # pre = last_name\n","  else:\n","    last_name = 8\n","\n","\n","\n","\n","  opas = '/static/results/default-generated-125/' ##関数の方がいいかも\n","  path =\"newimage-\"\n","  image_path = opas+path+\"1\"+\".jpg\"\n","  image_path1 = opas+path+\"2\"+\".jpg\"\n","  image_path2 = opas+path+\"3\"+\".jpg\"\n","  image_path3 = opas+path+\"4\"+\".jpg\"\n","  image_path4 = opas+path+\"5\"+\".jpg\"\n","  image_path5 = opas+path+\"6\"+\".jpg\"\n","  image_path6 = opas+path+\"7\"+\".jpg\"\n","  image_path7 = opas+path+\"8\"+\".jpg\"\n","\n","\n","    #return send_file(image_path,as_attachment =True)\n","\n","  dir_result = model.generate('newimage', int(last_name), checkpoint, 'default')\n","  #number = str(random.randrange(0,29)) #ここでランダムに変える\n","  #return render_template('lgan.html',image_path = opas+path+number+\".jpg\")\n","\n","\n","\n","  return render_template('lgan.html',image_path = image_path, image_path1 = image_path1,image_path2 = image_path2,image_path3 = image_path3,\n","                         image_path4 = image_path4,image_path5 = image_path5,image_path6 = image_path6,image_path7 = image_path7,\n","                         last_name=last_name,err = err)\n","  #, pre = pre)\n","\n","@app.route('/upload', methods=['POST'])\n","def regist():\n","    # 画像を登録する\n","    # 登録画像は jpeg、png 形式に限定\n","    # ただし、ここでファイル種別のチェック処理はやっていない\n","    print('>>> regist() called:')\n","    # 画像データを取り出す\n","    file = request.files['file_content']\n","    # アップロードされた画像データを受け取って ./static フォルダへ保存\n","    file.save(os.path.join('./static', file.filename))\n","    # 登録済み画像一覧ページを表示\n","    return render_template('list.html', imglst=get_list())\n","\n","if __name__ == '__main__':\n","    app.run()"]},{"cell_type":"code","source":["! pwd"],"metadata":{"id":"8X75o2fz34cY"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[{"file_id":"1aSfAzR1XuGsnp3tbN-GQnGwWXFP2ScBF","timestamp":1670543692947},{"file_id":"1mYpdL9ySTSemlaFyv9YDCWRyS1b9pXHS","timestamp":1668045266021},{"file_id":"14DPqpJFkXG2vu-GhscBH0eGJDvzigcKR","timestamp":1667514615052},{"file_id":"1LuOhNIxa9pv07RWgkgFf5yRj_IOXxGWE","timestamp":1667475047457},{"file_id":"1VpyxRar9p_vc89AalO7n0HvHZTj0cZ9E","timestamp":1605079582122},{"file_id":"1Tp83VNFgdNXeyxywXiirWyQwLuGCTCZi","timestamp":1592986655428},{"file_id":"1vFPwrKYk_uqZ6hm534tB2ecUYD1c2mMH","timestamp":1592033734720}],"collapsed_sections":["FXrAKlGHjZro","dWGteNgVjmbV","6WAK0J6-QD76","pec1k-VZthtM","x-Ba5hbjv1j6","fnlxawYfwo8W","802XXk5YzDmf","AHUfTOPMoO6O"]},"kernelspec":{"display_name":"Python 3","name":"python3"},"gpuClass":"standard","accelerator":"GPU"},"nbformat":4,"nbformat_minor":0}